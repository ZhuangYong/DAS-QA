webpackJsonp([20],{1107:function(e,t,i){e.exports=i.p+"img/voice_search.png?8a63eecba6311d50f7ffeb0270535a79"},1108:function(e,t,i){var n=i(1109);"string"==typeof n&&(n=[[e.i,n,""]]);i(286)(n,{});n.locals&&(e.exports=n.locals)},1109:function(e,t,i){t=e.exports=i(285)(),t.push([e.i,"@keyframes voiceSearchBiggerA{0%{-webkit-transform:scale(1);transform:scale(1);opacity:.2}to{-webkit-transform:scale(4);transform:scale(4);opacity:0}}.btnBfAnimationA,.btnBfAnimationB{background-color:#ff6c00;border-radius:100%;animation:voiceSearchBiggerA 1.5s linear infinite;-moz-animation:voiceSearchBiggerA 1.5s linear infinite;-webkit-animation:voiceSearchBiggerA 1.5s linear infinite;-o-animation:voiceSearchBiggerA 1.5s linear infinite}.btnBfAnimationB{animation-delay:1s}@keyframes voiceSearchScaleA{0%{height:30px}50%{height:15px}to{height:30px}}@keyframes voiceSearchScaleB{0%{height:15px}50%{height:30px}to{height:15px}}.voiceSearchScaleBox{display:flex;margin:0 auto;width:35px!important;height:30px!important;justify-content:space-between;align-items:center}.voiceSearchScaleBox .voiceSearchScaleLong{width:6px;background-color:#fff;border-radius:6px;animation:voiceSearchScaleA 1.5s linear infinite;-moz-animation:voiceSearchScaleA 1.5s linear infinite;-webkit-animation:voiceSearchScaleA 1.5s linear infinite;-o-animation:voiceSearchScaleA 1.5s linear infinite}.voiceSearchScaleBox .voiceSearchScaleShort{width:6px;background-color:#fff;border-radius:6px;animation:voiceSearchScaleB 1.5s linear infinite;-moz-animation:voiceSearchScaleB 1.5s linear infinite;-webkit-animation:voiceSearchScaleB 1.5s linear infinite;-o-animation:voiceSearchScaleB 1.5s linear infinite}",""])},767:function(e,t,i){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function defineProperties(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,i){return t&&defineProperties(e.prototype,t),i&&defineProperties(e,i),e}}(),r=function get(e,t,i){null===e&&(e=Function.prototype);var n=Object.getOwnPropertyDescriptor(e,t);if(void 0===n){var r=Object.getPrototypeOf(e);return null===r?void 0:get(r,t,i)}if("value"in n)return n.value;var o=n.get;if(void 0!==o)return o.call(i)},o=i(0),a=_interopRequireDefault(o),c=i(777),s=_interopRequireDefault(c),u=i(105),l=i(106),f=i(288),p=_interopRequireDefault(f),d=i(1),v=_interopRequireDefault(d),h=i(307),m=(_interopRequireDefault(h),i(1107)),S=_interopRequireDefault(m);i(1108);var b=i(283),_=i(287),g=i(19),y=_interopRequireDefault(g),w={btn:{display:"flex",alignItems:"center",justifyContent:"center",background:"#ff6c00 url("+S.default+") no-repeat center",backgroundSize:"auto 35px",position:"absolute",top:"120px",left:"50%",marginLeft:"-42.5px",width:"80px",height:"80px",borderRadius:"80px"},headerDesc:{color:"#7e7e7e",fontSize:"14px"}},x=function(e){function VoiceSearch(e){_classCallCheck(this,VoiceSearch);var t=_possibleConstructorReturn(this,(VoiceSearch.__proto__||Object.getPrototypeOf(VoiceSearch)).call(this,e));return r(VoiceSearch.prototype.__proto__||Object.getPrototypeOf(VoiceSearch.prototype),"title",t).call(t,"语音搜索"),t.state={isRecordStart:!1,pageState:0,stopRecordTimer:null,startX:null,startY:null,btnDisabled:!1},t}return _inherits(VoiceSearch,e),n(VoiceSearch,[{key:"componentDidMount",value:function(){var e=this;document.addEventListener("touchend",function(t){e.state.isRecordStart&&(e.setState({isRecordStart:!1,pageState:0}),e.voiceRecognite(!1))})}},{key:"componentWillUnmount",value:function(){this.state.isRecordStart&&this.stopRecord(0);var e=this.state.stopRecordTimer;null!==e&&clearTimeout(e),document.removeEventListener("touchend")}},{key:"render",value:function(){var e=this,t=this.state.isRecordStart;return a.default.createElement("div",null,this.pageStateRecognite(),a.default.createElement("section",{style:{position:"absolute",width:"100%",height:"300px",bottom:0,left:0,overflow:"hidden"},onTouchStart:function(e){e.preventDefault()},onTouchMove:function(e){e.preventDefault()},onTouchEnd:function(e){e.preventDefault()}},a.default.createElement("header",{style:{marginTop:"90px",textAlign:"center",color:"#ff8226",fontSize:"18px"}},t?"点击停止":"点击说话"),a.default.createElement("div",{style:w.btn,onTouchStart:function(t){if(t.preventDefault(),!window.sysInfo.isWeixin)return void e.props.action_setGlobAlert("请在微信客户端操作");var i=t.targetTouches[0];e.setState({startX:i.pageX,startY:i.pageY,pageState:1,isRecordStart:!0}),e.voiceRecognite(!0)},onTouchMove:function(t){t.preventDefault();var i=e.state.startX,n=e.state.startY,r=t.targetTouches[0],o=r.pageX,a=r.pageY;(Math.abs(o-i)>80||Math.abs(a-n)>80)&&e.stopRecord()},onTouchEnd:function(e){e.preventDefault()}}),t&&a.default.createElement("div",null,a.default.createElement("div",{className:"btnBfAnimationA",style:w.btn}),a.default.createElement("div",{className:"btnBfAnimationB",style:w.btn}))))}},{key:"pageStateRecognite",value:function(){var e=this.state.pageState,t={title:"",textA:"",textB:""};switch(e){case 0:t.title="你可以这样说",t.textA="三生三世",t.textB="";break;case 1:t.title="正在听......",t.textA="贴近手机话筒说话",t.textB="保证声音更清晰哟";break;case 2:t.title="网络开小差咯",t.textA="检查一下网络吧",t.textB="";break;case 3:t.title="无法识别",t.textA="再说清楚一点",t.textB="才能帮你找到歌曲哟"}return a.default.createElement("section",{style:{padding:"40px 40px"}},a.default.createElement("header",{style:{color:"#252525",fontSize:"18px"}},t.title),a.default.createElement("p",{style:w.headerDesc},t.textA),a.default.createElement("p",{style:w.headerDesc},t.textB))}},{key:"voiceRecognite",value:function(e){var t=this;if(!window.navigator.onLine)return void this.setState({isRecordStart:!1,pageState:2});var i=this.props.action_setGlobAlert,n=this.state.stopRecordTimer;null!==n&&clearTimeout(n),e?window.wx&&window.wx.startRecord({success:function(){n=setTimeout(function(){t.voiceRecognite(!1)},3e4)},fail:function(){t.setState({pageState:0,isRecordStart:!e}),i("",y.default.COMMON.ALERT_TYPE_WX_API_FAIL)}}):window.wx&&window.wx.stopRecord({success:function(i){window.wx.translateVoice({localId:i.localId,isShowProgressTips:1,success:function(e){if("/voiceSearch"===window.location.pathname){var i=e.translateResult;void 0!==i?(0,b.linkTo)("song/search/"+encodeURIComponent((0,b.stripScript)(i)),!1,null):t.setState({isRecordStart:!1,pageState:3})}},fail:function(){t.setState({pageState:3,isRecordStart:e})}})},fail:function(){t.setState({pageState:3,isRecordStart:e})}})}},{key:"stopRecord",value:function(e){var t=this;window.wx&&window.wx.stopRecord({fail:function(){t.setState({pageState:0,isRecordStart:!1})}})}}]),VoiceSearch}(s.default);x.defaultProps={result:{}},x.propTypes={result:v.default.object};var R=function(e,t){return{}},E=function(e,t){return{action_setGlobAlert:(0,p.default)(_.setGlobAlert,e)}};t.default=(0,l.withRouter)((0,u.connect)(R,E)(x))},777:function(e,t,i){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function defineProperties(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,i){return t&&defineProperties(e.prototype,t),i&&defineProperties(e,i),e}}(),r=i(0),o=i(284),a=_interopRequireDefault(o),c=(i(106),i(105),i(19)),s=_interopRequireDefault(c),u=function(e){function BaseComponent(e){_classCallCheck(this,BaseComponent);var t=_possibleConstructorReturn(this,(BaseComponent.__proto__||Object.getPrototypeOf(BaseComponent)).call(this,e));return t.bindState.bind(t),t.title=t.title.bind(t),a.default.setHistory(t.props.history),t}return _inherits(BaseComponent,e),n(BaseComponent,[{key:"render",value:function(){return React.createElement("div",null)}},{key:"bindState",value:function(e){var t=this;return function(i){var n={};n[e]=i,t.setState(n)}}},{key:"title",value:function(e){document.title=e}},{key:"validUserStatus",value:function(e,t,i){var n=t||{},r=n.data,o=r||{},a=o.systemTime,c=o.timeStamp,u=this.isVip(e),l=this.isBindDevice(e),f=this.isFreeActivation(e);if("string"==typeof l)return i&&i(l),"正在获取用户信息";if(!1===l)return i&&i("",s.default.COMMON.ALERT_TYPE_BIND_DEVICE),!1;if(!0===l){if(!0===f)return i&&i("",s.default.COMMON.ALERT_TYPE_FREE_ACTIVE),!1;if(!1===f)return function(){return!(!a||!c)&&!(a-c>72e4)}()?!1!==u||(i&&i("",s.default.COMMON.ALERT_TYPE_BE_VIP),!1):(i&&i("",s.default.COMMON.ALERT_TYPE_DEVICE_NOT_ONLINE),!1)}}},{key:"validUserBindDevice",value:function(e,t){var i=this.isBindDevice(e);return"string"==typeof i?(t&&t(i),i):!1===i?(t&&t("",s.default.COMMON.ALERT_TYPE_BIND_DEVICE),!1):!0===i||void 0}},{key:"validUserDeviceOnline",value:function(e,t){var i=e||{},n=i.data,r=n||{},o=r.systemTime,a=r.timeStamp;if(o&&a){return!!!(o-a>72e4)||(t&&t("",s.default.COMMON.ALERT_TYPE_DEVICE_NOT_ONLINE),!1)}return t&&t("",s.default.COMMON.ALERT_TYPE_DEVICE_NOT_ONLINE),!1}},{key:"isFreeActivation",value:function(e){var t=e||{},i=t.status,n=t.data;if(void 0!==i){return 1===n.isFreeActivation}return"正在获取用户信息"}},{key:"isBindDevice",value:function(e){var t=e||{},i=t.status,n=t.msg,r=t.data;if(void 0!==i){if(-100===i)return"请使用微信操作";if(1===i){var o=r.isReDevice;r.bindExpireTime;return 1===o}return n||"获取用户信息失败，请稍后重试！"}return"正在获取用户信息"}},{key:"isVip",value:function(e){var t=e||{},i=t.status,n=t.data;if(void 0!==i){var r=n.vipStatus,o=n.expireTime;return 1===r&&(new Date).getTime()<o}return"正在获取用户信息"}},{key:"vipTime",value:function(e){var t=e||{},i=t.status,n=t.data;if(void 0!==i){var r=n.vipStatus,o=n.expireTime;return 1===r?o-(new Date).getTime():"0"}return"正在获取用户信息"}}]),BaseComponent}(r.Component);t.default=u}});