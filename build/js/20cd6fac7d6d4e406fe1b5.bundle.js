webpackJsonp([20],{1095:function(e,t,i){e.exports=i.p+"img/voice_search.png?8a63eecba6311d50f7ffeb0270535a79"},1096:function(e,t,i){var n=i(1097);"string"==typeof n&&(n=[[e.i,n,""]]);i(289)(n,{});n.locals&&(e.exports=n.locals)},1097:function(e,t,i){t=e.exports=i(288)(),t.push([e.i,"@keyframes voiceSearchBiggerA{0%{-webkit-transform:scale(1);transform:scale(1);opacity:.2}to{-webkit-transform:scale(4);transform:scale(4);opacity:0}}.btnBfAnimationA,.btnBfAnimationB{background-color:#ff6c00;border-radius:100%;animation:voiceSearchBiggerA 1.5s linear infinite;-moz-animation:voiceSearchBiggerA 1.5s linear infinite;-webkit-animation:voiceSearchBiggerA 1.5s linear infinite;-o-animation:voiceSearchBiggerA 1.5s linear infinite}.btnBfAnimationB{animation-delay:1s}@keyframes voiceSearchScaleA{0%{height:30px}50%{height:15px}to{height:30px}}@keyframes voiceSearchScaleB{0%{height:15px}50%{height:30px}to{height:15px}}.voiceSearchScaleBox{display:flex;margin:0 auto;width:35px!important;height:30px!important;justify-content:space-between;align-items:center}.voiceSearchScaleBox .voiceSearchScaleLong{width:6px;background-color:#fff;border-radius:6px;animation:voiceSearchScaleA 1.5s linear infinite;-moz-animation:voiceSearchScaleA 1.5s linear infinite;-webkit-animation:voiceSearchScaleA 1.5s linear infinite;-o-animation:voiceSearchScaleA 1.5s linear infinite}.voiceSearchScaleBox .voiceSearchScaleShort{width:6px;background-color:#fff;border-radius:6px;animation:voiceSearchScaleB 1.5s linear infinite;-moz-animation:voiceSearchScaleB 1.5s linear infinite;-webkit-animation:voiceSearchScaleB 1.5s linear infinite;-o-animation:voiceSearchScaleB 1.5s linear infinite}",""])},763:function(e,t,i){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function defineProperties(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,i){return t&&defineProperties(e.prototype,t),i&&defineProperties(e,i),e}}(),o=function get(e,t,i){null===e&&(e=Function.prototype);var n=Object.getOwnPropertyDescriptor(e,t);if(void 0===n){var o=Object.getPrototypeOf(e);return null===o?void 0:get(o,t,i)}if("value"in n)return n.value;var a=n.get;if(void 0!==a)return a.call(i)},a=i(0),r=_interopRequireDefault(a),c=i(287),l=_interopRequireDefault(c),s=i(87),u=i(106),f=i(291),p=_interopRequireDefault(f),d=i(1),h=_interopRequireDefault(d),S=i(310),v=(_interopRequireDefault(S),i(1095)),g=_interopRequireDefault(v);i(1096);var m=i(286),b=i(290),x=i(18),w=_interopRequireDefault(x),y={btn:{display:"flex",alignItems:"center",justifyContent:"center",background:"#ff6c00 url("+g.default+") no-repeat center",backgroundSize:"auto 35px",position:"absolute",top:"120px",left:"50%",marginLeft:"-42.5px",width:"80px",height:"80px",borderRadius:"80px"},headerDesc:{color:"#7e7e7e",fontSize:"14px"}},R=function(e){function VoiceSearch(e){_classCallCheck(this,VoiceSearch);var t=_possibleConstructorReturn(this,(VoiceSearch.__proto__||Object.getPrototypeOf(VoiceSearch)).call(this,e));return o(VoiceSearch.prototype.__proto__||Object.getPrototypeOf(VoiceSearch.prototype),"title",t).call(t,"语音搜索"),t.state={isRecordStart:!1,pageState:0,stopRecordTimer:null,startX:null,startY:null,btnDisabled:!1},t}return _inherits(VoiceSearch,e),n(VoiceSearch,[{key:"componentDidMount",value:function(){var e=this;document.addEventListener("touchend",function(t){e.state.isRecordStart&&(e.setState({isRecordStart:!1,pageState:0}),e.voiceRecognite(!1))})}},{key:"componentWillUnmount",value:function(){this.state.isRecordStart&&this.stopRecord(0);var e=this.state.stopRecordTimer;null!==e&&clearTimeout(e),document.removeEventListener("touchend")}},{key:"render",value:function(){var e=this,t=this.state.isRecordStart;return r.default.createElement("div",null,this.pageStateRecognite(),r.default.createElement("section",{style:{position:"absolute",width:"100%",height:"300px",bottom:0,left:0,overflow:"hidden"},onTouchStart:function(e){e.preventDefault()},onTouchMove:function(e){e.preventDefault()},onTouchEnd:function(e){e.preventDefault()}},r.default.createElement("header",{style:{marginTop:"90px",textAlign:"center",color:"#ff8226",fontSize:"18px"}},t?"点击停止":"点击说话"),r.default.createElement("div",{style:y.btn,onTouchStart:function(t){if(t.preventDefault(),!window.sysInfo.isWeixin)return void e.props.action_setGlobAlert("请在微信客户端操作");var i=t.targetTouches[0];e.setState({startX:i.pageX,startY:i.pageY,pageState:1,isRecordStart:!0}),e.voiceRecognite(!0)},onTouchMove:function(t){t.preventDefault();var i=e.state.startX,n=e.state.startY,o=t.targetTouches[0],a=o.pageX,r=o.pageY;(Math.abs(a-i)>80||Math.abs(r-n)>80)&&e.stopRecord()},onTouchEnd:function(e){e.preventDefault()}}),t&&r.default.createElement("div",null,r.default.createElement("div",{className:"btnBfAnimationA",style:y.btn}),r.default.createElement("div",{className:"btnBfAnimationB",style:y.btn}))))}},{key:"pageStateRecognite",value:function(){var e=this.state.pageState,t={title:"",textA:"",textB:""};switch(e){case 0:t.title="你可以这样说",t.textA="三生三世",t.textB="";break;case 1:t.title="正在听......",t.textA="贴近手机话筒说话",t.textB="保证声音更清晰哟";break;case 2:t.title="网络开小差咯",t.textA="检查一下网络吧",t.textB="";break;case 3:t.title="无法识别",t.textA="再说清楚一点",t.textB="才能帮你找到歌曲哟"}return r.default.createElement("section",{style:{padding:"40px 40px"}},r.default.createElement("header",{style:{color:"#252525",fontSize:"18px"}},t.title),r.default.createElement("p",{style:y.headerDesc},t.textA),r.default.createElement("p",{style:y.headerDesc},t.textB))}},{key:"voiceRecognite",value:function(e){var t=this;if(!window.navigator.onLine)return void this.setState({isRecordStart:!1,pageState:2});var i=this.props.action_setGlobAlert,n=this.state.stopRecordTimer;null!==n&&clearTimeout(n),e?window.wx&&window.wx.startRecord({success:function(){n=setTimeout(function(){t.voiceRecognite(!1)},3e4)},fail:function(){t.setState({pageState:0,isRecordStart:!e}),i("",w.default.COMMON.ALERT_TYPE_WX_API_FAIL)}}):window.wx&&window.wx.stopRecord({success:function(i){window.wx.translateVoice({localId:i.localId,isShowProgressTips:1,success:function(e){if("/voiceSearch"===window.location.pathname){var i=e.translateResult;void 0!==i?(0,m.linkTo)("song/search/"+encodeURIComponent((0,m.stripScript)(i)),!1,null):t.setState({isRecordStart:!1,pageState:3})}},fail:function(){t.setState({pageState:3,isRecordStart:e})}})},fail:function(){t.setState({pageState:3,isRecordStart:e})}})}},{key:"stopRecord",value:function(e){var t=this;window.wx&&window.wx.stopRecord({fail:function(){t.setState({pageState:0,isRecordStart:!1})}})}}]),VoiceSearch}(l.default);R.defaultProps={result:{}},R.propTypes={result:h.default.object};var _=function(e,t){return{}},A=function(e,t){return{action_setGlobAlert:(0,p.default)(b.setGlobAlert,e)}};t.default=(0,u.withRouter)((0,s.connect)(_,A)(R))}});