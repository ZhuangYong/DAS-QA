webpackJsonp([15],{758:function(e,t,n){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}(),i=function get(e,t,n){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,t);if(void 0===o){var i=Object.getPrototypeOf(e);return null===i?void 0:get(i,t,n)}if("value"in o)return o.value;var r=o.get;if(void 0!==r)return r.call(n)},r=n(0),a=_interopRequireDefault(r),l=n(282),s=_interopRequireDefault(l),u=n(85),c=n(102),d=n(286),p=_interopRequireDefault(d),f=n(1),h=_interopRequireDefault(f),b=n(287),g=n(281),m=n(289),y=n(309),v=_interopRequireDefault(y),_=n(288),x=_interopRequireDefault(_),w=n(808),k=_interopRequireDefault(w),C=n(845),E=_interopRequireDefault(C),P=n(846),I=_interopRequireDefault(P),S=n(169),q=_interopRequireDefault(S),R=n(797),B=_interopRequireDefault(R),O=n(285),T=n(18),D=_interopRequireDefault(T),A={sectionHeader:{paddingLeft:"10px",width:"100%",height:"50px",lineHeight:"50px",fontSize:"18px"},questionsTile:{boxSizing:"border-box",padding:"5px"},questionsContent:{width:"100%",height:"100%",backgroundColor:"#bcbcbc",lineHeight:"30px",textAlign:"center",borderRadius:"4px",color:"#080808",fontSize:"14px"},questionsContentActive:{width:"100%",height:"100%",backgroundColor:"#ff8632",lineHeight:"30px",textAlign:"center",borderRadius:"4px",color:"#fff",fontSize:"14px"},questionDesc:{paddingTop:"5px",paddingRight:"10px",paddingLeft:"10px",width:"100%",height:"120px",color:"#040404",fontSize:"14px",border:"none",resize:"none",boxSizing:"border-box"},questionDescTip:{paddingRight:"10px",width:"100%",height:"30px",lineHeight:"30px",backgroundColor:"#fff",marginTop:"-5px",fontSize:"14px",textAlign:"right",color:"#808080"},submitBtn:{display:"block",borderRadius:"50px",margin:"0 auto",width:"240px",height:"50px"}},j={isShowAddBtn:!0,id:"addBtn"},L=function(e){function Feedback(e){_classCallCheck(this,Feedback);var t=_possibleConstructorReturn(this,(Feedback.__proto__||Object.getPrototypeOf(Feedback)).call(this,e));return i(Feedback.prototype.__proto__||Object.getPrototypeOf(Feedback.prototype),"title",t).call(t,"意见反馈"),t.state={matchParams:t.props.match.params,questionList:[],imgList:[j],submitParams:{questionIds:null,content:"",imgIds:null,tel:null},showAlert:!1,globAlert:"toast"},t.addBtnClick=t.addBtnClick.bind(t),t.submit=t.submit.bind(t),t.closePage=t.closePage.bind(t),t}return _inherits(Feedback,e),o(Feedback,[{key:"componentDidUpdate",value:function(e){var t=this.props.match.params;e.match.params.state!==t.state&&this.setState({matchParams:t})}},{key:"componentDidMount",value:function(){var e={};this.props.getFeedbackQuestionListAction(e,(0,g.reqHeader)(e))}},{key:"render",value:function(){var e=this,t=this.props.questionList.questionListData||{data:{}},n=t.data,o=n||{},i=o.result,r=i||[],l=this.state.submitParams;return null===l.questionIds&&r[0]&&(l.questionIds=r[0].id),a.default.createElement("div",null,this.matchPages()?a.default.createElement("div",null,a.default.createElement("section",{style:{backgroundColor:"#eee"}},a.default.createElement("header",null,a.default.createElement("div",{style:A.sectionHeader},"问题类型")),a.default.createElement(m.GridList,{cellHeight:40,cols:3,padding:0,style:{paddingLeft:"5px",paddingRight:"5px"}},r.map(function(t){return a.default.createElement(m.GridTile,{key:t.id,style:A.questionsTile,onTouchTap:function(){l.questionIds=t.id,e.setState({submitParams:l})}},a.default.createElement("div",{style:l.questionIds===t.id?A.questionsContentActive:A.questionsContent},t.questionName))}))),a.default.createElement("section",{style:{position:"relative",overflow:"hidden",backgroundColor:"#eee"}},a.default.createElement("header",null,a.default.createElement("div",{style:A.sectionHeader},"问题描述")),a.default.createElement("textarea",{style:A.questionDesc,placeholder:"亲爱的麦粉，把你遇到的问题或建议写下来吧......",onChange:function(t){var n=t.target.value;n.length>=200&&(t.target.value=n.slice(0,200),e.setState({showAlert:!0,globAlert:"字太多啦，不准写了"})),l.content=n.slice(0,200),e.setState({submitParams:l})}}),a.default.createElement("div",null,a.default.createElement("div",{style:A.questionDescTip},this.state.submitParams.content.length<=0?"至少10个字，最多200字，不然宝宝要生气!":this.state.submitParams.content.length+"/200")),a.default.createElement(v.default,{open:this.state.showAlert,message:this.state.globAlert,autoHideDuration:2e3,onRequestClose:function(){e.setState({showAlert:!1})},style:{position:"absolute"}})),a.default.createElement("section",{style:{backgroundColor:"#eee"}},a.default.createElement("header",null,a.default.createElement("span",{style:A.sectionHeader},"上传照片"),a.default.createElement("span",{style:{marginLeft:"5px",fontSize:"12px",color:"#808080"}},"最多5张")),a.default.createElement(E.default,{cols:5,badgeBackgroundColor:"#ce0000",itemStyle:{padding:"3px"},badgeContent:a.default.createElement(k.default,{style:{width:"20px",height:"20px"},color:"#fff",onClick:function(t){var n=t.target.parentNode.parentNode.dataset.id,o=e.state.imgList.filter(function(e){if(parseInt(e.id,10)!==parseInt(n,10))return e});o.length>=4&&o[o.length-1].isShowBadge&&o.push(j),e.setState({imgList:o})}}),badgeStyle:{width:"20px",height:"20px"},data:this.state.imgList,addBtnTouchTap:this.addBtnClick})),a.default.createElement("section",{style:{backgroundColor:"#eee"}},a.default.createElement("header",null,a.default.createElement("div",{style:A.sectionHeader},"联系方式")),a.default.createElement("div",{style:{paddingLeft:"10px",paddingRight:"10px"}},a.default.createElement("input",{type:"text",placeholder:"手机、QQ或邮箱",style:{width:"100%",height:"50px",backgroundColor:"#fff",border:"none",fontSize:"18px",textIndent:"10px",borderRadius:"4px"},maxLength:30,onChange:function(t){l.tel=t.target.value,e.setState({submitParams:l})}}))),a.default.createElement("section",{style:{backgroundColor:"#eee",padding:"20px 10px"}},a.default.createElement(x.default,{backgroundColor:"#ff8632",disabledBackgroundColor:"#ccc",disabled:null===this.state.submitParams.questionIds||this.state.submitParams.content.length<10,label:"提交",style:A.submitBtn,buttonStyle:A.submitBtn,labelStyle:{lineHeight:"50px",fontSize:"18px",color:"#fff"},onClick:this.submit}))):a.default.createElement(B.default,{src:I.default,content:a.default.createElement("div",null,a.default.createElement("p",{style:{textAlign:"center",color:"#ff8632",fontSize:"16px"}},"提交成功"),a.default.createElement("p",{style:{textAlign:"center",color:"#807f7e",fontSize:"14px"}},"我们将会在第一时间处理，感谢您的反馈！")),imgStyle:{width:"100px"},buttonLabel:"关闭",touchTap:this.closePage}))}},{key:"closePage",value:function(){"undefined"!==this.state.matchParams.deviceId?window.WeixinJSBridge.call("closeWindow"):window.history.back()}},{key:"matchPages",value:function(){var e=null;switch(this.props.match.params.state){case"home":e=!0;break;case"success":e=!1;break;default:q.default.replace("/*")}return e}},{key:"submit",value:function(){var e=null,t=this.props.action_setGlobAlert,n=this.state.submitParams;if(null===n.questionIds)return void t("至少选择一个问题类型");if(n.content=n.content.trim(),n.content.length<=0)return void t("认真点！还差几个字");var o=[];this.state.imgList.forEach(function(e,t){e.isShowAddBtn||o.push(e.id)}),n.imgIds=o.join(",");var i=this.state.matchParams;if(void 0!==i.deviceId){var r=(0,g.getEncryptHeader)({deviceId:i.deviceId});e=(0,g.reqHeader)(n,r)}else e=(0,g.reqHeader)(n);this.props.feedbackSubmitAction(n,e,function(e){var n=e.status;e.msg;1===n?q.default.replace("/user/feedback/success/"+i.deviceId):t("网络开小差咯")})}},{key:"addBtnClick",value:function(){var e=this;window.sysInfo.isWeixin?window.wx&&window.wx.chooseImage({count:1,sizeType:["original","compressed"],sourceType:["album","camera"],success:function(t){t.localIds.map(function(t){window.wx.uploadImage({localId:t,isShowProgressTips:1,success:function(t){var n={mediaId:t.serverId};e.props.uploadImgAction(n,(0,g.reqHeader)(n),function(t){var n=t.data;n[0].isShowBadge=!0;var o=e.state.imgList;o.length>=5&&o[o.length-1].isShowAddBtn&&o.pop(),e.setState({imgList:[n[0]].concat(_toConsumableArray(o))})})}})})},fail:function(){e.props.action_setGlobAlert("",D.default.COMMON.ALERT_TYPE_WX_API_FAIL)}}):this.props.action_setGlobAlert("请在微信客户端上传图片")}}]),Feedback}(s.default);L.defaultProps={questionList:{},uploadImgData:{}},L.propTypes={questionList:h.default.object,uploadImgData:h.default.object};var z=function(e,t){return{questionList:e.app.user.feedback,uploadImgData:e.app.user.uploadImg}},H=function(e,t){return{getFeedbackQuestionListAction:(0,p.default)(b.getFeedbackQuestionList,e),uploadImgAction:(0,p.default)(b.uploadImgWeiXin,e),feedbackSubmitAction:(0,p.default)(b.feedbackSubmit,e),action_setGlobAlert:(0,p.default)(O.setGlobAlert,e)}};t.default=(0,c.withRouter)((0,u.connect)(z,H)(L))},797:function(e,t,n){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},i=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}(),r=n(0),a=_interopRequireDefault(r),l=n(288),s=_interopRequireDefault(l),u=(n(166),{submitBtn:{position:"absolute",left:"50%",bottom:"80px",marginLeft:"-120px",width:"240px",height:"50px",borderRadius:"50px",overflow:"hidden"}}),c=function(e){function ButtonPage(e){return _classCallCheck(this,ButtonPage),_possibleConstructorReturn(this,(ButtonPage.__proto__||Object.getPrototypeOf(ButtonPage)).call(this,e))}return _inherits(ButtonPage,e),i(ButtonPage,[{key:"render",value:function(){return a.default.createElement("section",{style:o({},{width:"100%"},this.props.style)},a.default.createElement("header",null,this.props.headerDom||a.default.createElement("div",null,a.default.createElement("img",{style:o({},{display:"block",margin:"130px auto 0",width:"100px"},this.props.imgStyle),src:this.props.src,alt:""}),a.default.createElement("div",{style:o({},{marginTop:"8px",textAlign:"center",color:"#ff8632",fontSize:"18px"},this.props.contentStyle)},this.props.content))),!this.props.hideButton&&a.default.createElement(s.default,{icon:this.props.icon,disabled:this.props.disabled,backgroundColor:"#ff6832",disabledBackgroundColor:"#ccc",label:this.props.buttonLabel,style:o({},u.submitBtn,this.props.raisedButtonStyles),buttonStyle:this.props.buttonStyles,labelStyle:o({},{lineHeight:"50px",fontSize:"18px",color:"#fff"},this.props.buttonLabelStyles),onClick:this.props.touchTap}))}}]),ButtonPage}(a.default.Component);t.default=c},799:function(e,t,n){e.exports=n.p+"img/common/tile_default.jpg?ede3715f1c8a57f43847b8f53ec156a1"},808:function(e,t,n){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),i=_interopRequireDefault(o),r=n(23),a=_interopRequireDefault(r),l=n(20),s=_interopRequireDefault(l),u=function(e){return i.default.createElement(s.default,e,i.default.createElement("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}))};u=(0,a.default)(u),u.displayName="ContentClear",u.muiName="SvgIcon",t.default=u},845:function(e,t,n){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},i=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}(),r=n(0),a=_interopRequireDefault(r),l=n(16),s=n(289),u=n(293),c=_interopRequireDefault(u),d=n(799),p=_interopRequireDefault(d),f=n(20),h=_interopRequireDefault(f),b={tile:{display:"block",margin:"0 auto",padding:0,width:"72px",height:"70px",boxSizing:"border-box"},tileImg:{display:"block",margin:"auto",width:"100%",height:"100%"}},g=function(e){return a.default.createElement(h.default,{style:e.style,viewBox:"0 0 612 792"},a.default.createElement("polygon",{points:"612,376.893 325.116,376.893 325.116,90.296 286.903,90.296 286.903,376.893 0,376.893 0,415.107 286.903,415.107 286.903,701.704 325.116,701.704 325.116,415.107 612,415.107"}))},m=function(e){function InputBox(e){_classCallCheck(this,InputBox);var t=_possibleConstructorReturn(this,(InputBox.__proto__||Object.getPrototypeOf(InputBox)).call(this,e));return t.addBtnTouchTap=t.addBtnTouchTap.bind(t),t.listenInputChange=t.listenInputChange.bind(t),t}return _inherits(InputBox,e),i(InputBox,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this;return a.default.createElement(s.GridList,{cellHeight:"auto",cols:this.props.cols,style:o({},{margin:0,padding:"0 10px",boxSizing:"border-box"},this.props.style)},this.props.data.map(function(t){return a.default.createElement(c.default,{key:t.id,"data-id":t.id,style:o({},b.tile,e.props.itemStyle),badgeStyle:o({},{display:t.isShowBadge?"block":"none",position:"absolute",backgroundColor:e.props.badgeBackgroundColor||"#a4c639"},e.props.badgeStyle),badgeContent:e.props.badgeContent},t.isShowAddBtn?a.default.createElement("div",{style:o({},b.tileImg,{backgroundColor:"#fff",border:"1px solid #ccc"}),onClick:function(){e.addBtnTouchTap()}},a.default.createElement(g,{style:{position:"relative",top:"20%",left:"20%",width:"60%",height:"60%",color:"#ccc"}}),a.default.createElement("input",{ref:"addImgInp",type:"file",accept:"image/*",style:{display:"none"},onChange:e.listenInputChange})):a.default.createElement("img",{src:t.imgUrl,style:b.tileImg,onError:function(e){e.target.src=p.default},onTouchTap:function(){e.props.imgTouchTap&&e.props.imgTouchTap(t)}}))}))}},{key:"addBtnTouchTap",value:function(){var e=this.props.addBtnTouchTap;if(e)return void e();var t=this.props.addBtn;return t||!0===t.isLoadImg?this.addImgInp.click():alert(t.disabledTip||"不能再添加图片咯")}},{key:"listenInputChange",value:function(){var e=this,t=this.addImgInp.files[0];if(t){var n=new FileReader;n.onload=function(){var t=n.result.split(",")[1],o="data:image/png;base64,"+t;e.props.inputChange(o)},n.readAsDataURL(t)}}},{key:"addImgInp",get:function(){return this.refs?(0,l.findDOMNode)(this.refs.addImgInp):{}}}]),InputBox}(a.default.Component);t.default=m},846:function(e,t,n){e.exports=n.p+"img/submit_success.png?8b79c70c6f9f2d8b921f2325eb944b28"}});